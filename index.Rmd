---
title: "Touchdown your research"
author: "Marie-H√©l√®ne Brice, Kevin Cazelles, David Beauchesne & Steve Vissault"
date: "2018/02/16"
output:
  xaringan::moon_reader:
    css: [default, rd.css, rd-font.css, "hygge"]
    lib_dir: assets
    seal: false
    nature:
      highlightStyle: dracula
      countIncrementalSlides: false
      beforeInit: "macros.js"
---

class: title-slide, middle


# Touchdown your research with <img src="assets/img/rmarkdown.png" style="vertical-align: middle;margin:10px" width="120px"></img>


.instructors[
  **QCBS R Workshop**

  Marie-H√©l√®ne Brice, Kevin Cazelles,
  David Beauchesne & Steve Vissault
]

<img src="assets/img/inSileco.png" width="80px"></img>

<div style="color:white;">
.font60[Adapted from [Alison Hill](https://rmd4medicine.netlify.com/slides/01-rmd-anatomy.html#8)]
</div>

---

class: clear, middle, center

```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("assets/img/rmarkdown_rockstar.png")
```

.font80[Illustration from [@allisonhorst](https://twitter.com/allison_horst)]

---

class: clear, middle

## R Markdown universe

R Markdown produces dynamic document in a variety of format.

### Opens new possibilities with R:

* make CV, poster & online presentation
* format scientific paper (`rticles`)
* help to document your research through notebook (`bookdown`)
* build an academic blog or website (`blogdown`)

---

class: clear, middle

## But what's R Markdown?

- ["An authoring framework for data science."](https://rmarkdown.rstudio.com/lesson-1.html) (‚úîÔ∏è)
- [A document format (.Rmd).](https://bookdown.org/yihui/rmarkdown/) (‚úîÔ∏è)
- [An R package named rmarkdown.](https://rmarkdown.rstudio.com/docs/) (‚úîÔ∏è)
- ["A tool for integrating text, code, and results."](https://r4ds.had.co.nz/communicate-intro.html) (‚úîÔ∏è)
- ["A file format for making dynamic documents with R."](https://rmarkdown.rstudio.com/articles_intro.html) (‚úîÔ∏è)
- ["A computational document."](http://radar.oreilly.com/2011/07/wolframs-computational-documen.html) (‚úîÔ∏è)
- [Wizardry.](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/rmarkdown_wizards.png) (üßô)


---

class: inverse, center, middle

# Workshop objective

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top:-60px" size=1px width=720px></html> 

## Build a website | notebook | presentation with <code style="color:rgb(11, 43, 70)">rmarkdown</code> and deploys it on the web


---
class: inverse, center, middle

# Basic Anatomy

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html>

## R Markdown (`r icon::ii("social-markdown")` + `r icon::fa("r-project")`)

---

# Exercice

1. Open RStudio
2. File > New File > R Markdown
3. Fill the fields *author* and *title*
4. Set default output format to HTML
5. Look at the source, then üß∂ Knit to HTML.

### Try to identify these parts in the source and the output:

- The metadata
- The text `r icon::ii("social-markdown")`
- The code `r icon::fa("r-project")`
- The output

```{r, echo=FALSE}
countdown::countdown(minutes = 3, seconds = 0)
```

---


# How does R Markdown work?

.pull-left[
```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("assets/img/Rmdformat.png")
```
]

.pull-right[
- ü§∑
- I press knit, a document appears, and I believe that anything happening in between could be actual magic.
- `knitr` executes the code and converts `.Rmd` to `.md`; Pandoc renders the `.md` file to the output format you want.
]

---

class: middle, center, clear

![](https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/rmarkdown_wizards.png)

.font80[Illustration from [@allisonhorst](https://twitter.com/allison_horst)]

---
class: inverse, center, middle

#  Document metadata

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html> 

## R Markdown (`r icon::ii("social-markdown")` + `r icon::fa("r-project")`)

---

# Metadata and options

Metadata with options are defined in the header of the `.Rmd` document as a set of `key` and `value` (YAML syntax).

.pull-left[
### One output
```r
---
output: html_document
---
```
]

.pull-right[
### Two outputs
```r
---
output: 
html_document:
    toc: true
  pdf_document:
    toc: false
---
```
]

Options available depend on the output.  
See `?html_document `, `?pdf_document`, `?word_document`

???

- You have already notice the keys `author`, `title`, `date`
- What's the purpose of the indentation?

---

# Exercice

### Edit the output options

Use `?html_document` from your R console to:

1. Add a floating table of contents
2. Add a theme
3. Use the "kable" method to print data frames

üß∂ Knit to HTML to see the output.

If this was easy, try to embed the Rmd source code to download.

```{r, echo=FALSE}
countdown::countdown(minutes = 3, seconds = 0)
```

???

### Answer

```r
---
output:
  html_document:
    toc: true
    toc_float: true
    theme: flatly
    df_print: kable
    code_download: true
---

We have done a brief overview of the document options (the shape), we now make an
introduction of the content 

```

---
class: inverse, center, middle

#  Document content

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html> 

## R Markdown (`r icon::ii("social-markdown")` + `r icon::fa("r-project")`)


---

class: clear, middle, center

```{r echo=FALSE, out.width="80%"}
knitr::include_graphics("assets/img/rmarkdown_rockstar.png")
```

.font80[Illustration from [@allisonhorst](https://twitter.com/allison_horst)]

---
class: inverse, center, middle

# Text formatting

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html> 


## Markdown `r icon::ii("social-markdown")` 

---

# Text style

.pull-left[
````md
# Header 1
## Header 2
### Header 3
#### Header 4
  
*italic* or _italic_
**bold**
`code`
  
`r ''`
```r
library(tibble)
data(iris)
glimpse(as_tibble(iris))
```
````

]
.pull-right[
<h1 style="margin:0px;padding:0px">Header 1</h1>
<h2 style="margin:0px;padding:0px">Header 2</h2>
<h3 style="margin:0px;padding:0px">Header 3</h3>
<h4 style="margin:0px;padding:0px">Header 4</h4>
*italic* or _italic_  
**bold**  
`code`
```r
library(tibble)
data(iris)
glimpse(as_tibble(iris))

```
]

---

# Lists

.pull-left[
```md 
Lorem ipsum dolor sit amet, 
consectetur 
adipiscing elit.
 
- Cras convallis purus.
- Nunc faucibus.
- Maecenas ipsum dolor.

Nulla vehicula metus vel tortor 
venenatis luctus. 
Etiam tempus sit amet ligula
nec pretium. Aenean ultrices 
massa sed pulvinar pulvinar. 

1. Duis aliquam commodo volutpat. 
1. Mauris ultrices. 
1. Aliquam eu erat.
```
] 

.pull-right[
Lorem ipsum dolor sit amet, consectetur adipiscing elit.
 
* Cras convallis purus. 
- Nunc faucibus. 
* Maecenas ipsum dolor. 

Nulla vehicula metus vel tortor venenatis luctus.

1. Duis aliquam commodo volutpat. 
1. Mauris ultrices. 
1. Aliquam eu erat.
]


---

# Images

.pull-left[
```md 
![Hulk vs Trump](https://media.giphy.com/media/MkGyW2cOH7uhO/giphy.gif)
```
] 

.pull-right[
![Hulk vs Trump](https://media.giphy.com/media/MkGyW2cOH7uhO/giphy.gif)
]




---

# Links


.pull-left[
```md 
[Hulk vs Trump](https://media.giphy.com/media/MkGyW2cOH7uhO/giphy.gif)
![Hulk vs Trump](https://media.giphy.com/media/MkGyW2cOH7uhO/giphy.gif)
```
] 

.pull-right[
[Hulk vs Trump](https://media.giphy.com/media/MkGyW2cOH7uhO/giphy.gif)
![Hulk vs Trump](https://media.giphy.com/media/MkGyW2cOH7uhO/giphy.gif)
]


---

# Tables

.pull-left[

### Syntax


```md
| Time          | Session | Topic    |
|:--------------|:-------:|---------:|
| _left_        | _center_| _right_  |
| 01:00 - 01:50 | 1       | Anatomy  |
| 01:50 - 02:00 |         | *Break*  |
| 02:00 - 02:45 | 2       | Tables   |
| 02:45 - 03:00 |         | *Break*  |
```

]

.pull-right[

### Output  

  
| Time          | Session | Topic    |
|:--------------|:-------:|---------:|
| _left_        | _center_| _right_  |
| 01:00 - 01:50 | 1       | Anatomy  |
| 01:50 - 02:00 |         | *Break*  |
| 02:00 - 02:45 | 2       | Tables   |
| 02:45 - 03:00 |         | *Break*  |

]


- `r icon::fa("exclamation-triangle")` the `:` specify the alignement.
- Not convenient for long table, we will use instead `r icon::fa("r-project")` to print the markdown table for us.



---
class: inverse, center, middle

#  Code

<html><div style='float:left'></div><hr color='#ffdd55'style="margin-top: -60px;" size=1px width=720px></html> 

## The `r icon::fa("r-project")`  part

---

# Chunks

```{r include=FALSE}
knitr::opts_chunk$set(eval=FALSE)
```

````md
This text is written in markdown

```{r}
library(tibble)
data(iris)
glimpse(as_tibble(iris))
```
````



- `r icon::fa("exclamation-triangle")` `r` between brackets `{}`, why is that?
- Where is the `r icon::fa("r-project")` code and the `r icon::ii("social-markdown")` section?


---

# Chunks

### Code

```{r}
library(tibble)
data(iris)
glimpse(as_tibble(iris))
```

### Print output

```{r echo = FALSE, eval = TRUE}
library(tibble)
data(iris)
glimpse(as_tibble(iris))
```


---

# Chunks

.pull-left[
### Code

```{r}
library(ggplot2)
data(iris)
ggplot(data=iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point(aes(color=Species, shape=Species)) +
  xlab("Sepal Length") +  ylab("Sepal Width") +
  ggtitle("Sepal Length-Width")
```
]

.pull-right[
### Graphic output

```{r echo = FALSE, eval = TRUE, dpi=300}
library(ggplot2)
data(iris)
ggplot(data=iris, aes(x = Sepal.Length, y = Sepal.Width)) +
  geom_point(aes(color=Species, shape=Species)) +
  xlab("Sepal Length") +  ylab("Sepal Width") +
  ggtitle("Sepal Length-Width")
```
]

---

# Chunks

.pull-left[
### Code

```{r}
library(rbokeh)
data(iris)
figure() %>%
  ly_points(Sepal.Length, Sepal.Width, data = iris,
    color = Species, glyph = Species,
    hover = list(Sepal.Length, Sepal.Width))
```
]

.pull-right[
<h3 style="margin-bottom:10px;">Dynamic output</h3>

```{r echo = FALSE, eval = TRUE, message = FALSE, dpi=300}
library(dplyr)
library(leaflet)
leaflet(height=400, width=400) %>%
  addTiles() %>%  
  addMarkers(lng=174.768, lat=-36.852,
             popup="The birthplace of R")
```
]

```{r include=FALSE, eval = TRUE}
knitr::opts_chunk$set(eval=TRUE)
```

---

# Exercice

**TODO**: Play with `HTML widgets`

```{r, echo=FALSE}
countdown::countdown(minutes = 5, seconds = 0)
```

---
class: inverse, center, middle

# `r icon::fa("rocket")` Outputs

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html> 

---

# Chunk options

Chunk output can be customised with [numerous options](https://yihui.name/knitr/options/):

```{r}
str(knitr::opts_chunk$get())
```

---

# Chunk options

## Default options

.pull-left[
### Syntax
````md
```{r}`r ''`
glimpse(iris)
```
````
]

.pull-right[
### Output
```{r}
glimpse(iris)
```
]

---

# Chunk options

## echo

.pull-left[
### Syntax
````md
```{r echo = FALSE}`r ''`
glimpse(iris)
```
````
]

.pull-right[
### Output
```{r echo = FALSE}
glimpse(iris)
```
]

<br>

- Display results but not code.
- Useful to present results to people not interested by the code.
- Use `echo = -1` to hide only the first line of a code chunk. 

---

# Chunk options

## eval

.pull-left[
### Syntax
````md
```{r eval = FALSE}`r ''`
glimpse(iris)
```
````
]

.pull-right[
### Output
```{r eval = FALSE}
glimpse(iris)
```
]

<br>

- Code is not evaluated. 
- Useful to show exemple code.
- Use `eval = -1` to evaluate every line of a code chunk except the first. 


---

# Chunk options

## include

.pull-left[
### Syntax
````md
```{r include = FALSE}`r ''`
glimpse(iris)
```
````
]

.pull-right[
### Output
```{r include = FALSE}
glimpse(iris)
```
]

<br>

- Code is evaluated but no output (code, results and figures) is displayed. 
- Useful in setup options and package installation.

---

# Chunk options

## results

.pull-left[
### Syntax
````md
```{r results = "hold"}`r ''`
1 + 1
2 + 2
```
````
]

.pull-right[
### Output
```{r results = "hold"}
1 + 1
2 + 2
```
]


<br>

- Hold all results in a code chunk and display them at the end. 

---

# Chunk options

## results

.pull-left[
### Syntax
````md
```{r results = "hide"}`r ''`
1 + 1
ggplot(data = iris, 
       aes(x = Petal.Length, 
           y = Petal.Width)) +
  geom_point()
```
````

<br>

- Hide results but not plots

]

.pull-right[
### Output
```{r results = "hide", fig.height=3, fig.width=3, dpi = 300}
1 + 1
ggplot(data = iris,
       aes(x = Petal.Length, 
           y = Petal.Width)) +
  geom_point()
```
]




---

# Chunk options

## fig.height & fig.width

.pull-left[
### Syntax
````md
```{r fig.height = 3, fig.width = 5, echo = FALSE}`r ''`
ggplot(data = iris, 
       aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point()
```
````
]


.pull-right[
### Output
```{r fig.height = 3, fig.width = 5, echo = FALSE, dpi = 300}
ggplot(data = iris, 
       aes(x = Sepal.Length, 
           y = Sepal.Width, 
           color = Species)) +
  geom_point()
```
]

<br>

- width and height of the plot in inches
- Note that options are separated by commas

---
# Chunk options

### What output each option suppresses?

Option             | Run code | Show code | Output | Plots | Messages | Warnings 
-------------------|:--------:|:---------:|:------:|:-----:|:--------:|:-------:
`eval = FALSE`     |`r icon::fa("times")`|         |`r icon::fa("times")`|`r icon::fa("times")`|`r icon::fa("times")`|`r icon::fa("times")`
`include = FALSE`  | |`r icon::fa("times")`|`r icon::fa("times")`|`r icon::fa("times")`|`r icon::fa("times")`|`r icon::fa("times")` 
`echo = FALSE`     |  |`r icon::fa("times")`|     |    |      |     
`results = "hide"` |        |        |`r icon::fa("times")`|     |        | 
`fig.show = "hide"`|        |       |     | `r icon::fa("times")`|      |
`message = FALSE`  |          |           |        |       |`r icon::fa("times")`|
`warning = FALSE`  |          |           |        |       |          |`r icon::fa("times")`

Table from [R for Data Science](https://r4ds.had.co.nz/r-markdown.html#chunk-options)

---
# Global chunk options

## Setup

You can change the default chunk options for all following chunks in your document.

````md
```{r include = FALSE}`r ''`
knitr::opts_chunk$set(
  collapse = TRUE, 
  cache = TRUE,
  comment = "#>", 
  fig.width = 6,
  fig.align = "center"
)
```
````

---



# Exercice

**TODO**: Play with `echo` & `eval` and others



```{r, echo=FALSE}
countdown::countdown(minutes = 5, seconds = 0)
```

---

# Take home

#### TODO: https://rmd4medicine.netlify.com/slides/01-rmd-anatomy.html#78

---
class: inverse, center, middle

# `r icon::fa("rocket")` Slides

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html> 


---

# Motivation

1. Create a presentation :microphone:
  - for a tutorial
  - for conference

2. Use Markdown to quickly format your content

3. Insert code examples :gear:

4. Insert your R figures :bar_chart:


---

# Examples

Several [formats](https://rmarkdown.rstudio.com/formats.html) available

## [ioslides](https://bookdown.org/yihui/rmarkdown/ioslides-presentation.html)

```
---
title: "ResearchDown"
author: Liam Beauchesne
output: ioslides_presentation
---
```

## [Slidy](https://bookdown.org/yihui/rmarkdown/slidy-presentation.html)

```
---
title: "ResearchDown"
author: Liam Beauchesne
output: slidy_presentation
---
```

---

# Usage

## [Beamer](https://bookdown.org/yihui/rmarkdown/beamer-presentation.html)

```
---
title: "ResearchDown"
author: Liam Beauchesne
output: beamer_presentation
---
```

## [PowerPoint](https://bookdown.org/yihui/rmarkdown/powerpoint-presentation.html)


```
---
title: "Habits"
author: John Doe
date: March 22, 2005
output: powerpoint_presentation
---
```

---

# Usage

## [xaringan](https://slides.yihui.name/xaringan/#1)

```r
install.packages("xaringan")
```

```
---
title: "Talk"
subtitle: "Symposium"
author: "Liam Beauchesne"
output:
  xaringan::moon_reader:
---
```


---

# Resources

<br>

### [1. QCBS R workshops](https://qcbsrworkshops.github.io/)
### [2. ioslides](https://kevcaz.github.io/pres_Rmarkdown_fr/#1)
### [3. xaringan](https://slides.yihui.name/xaringan/#1)

---

# Get started

## [xaringan](https://slides.yihui.name/xaringan/#1)


```
---
title: "Workshop 1: Introduction to R"
subtitle: "QCBS R Workshop Series"
author: "Liam Beauchesne"
output:
  xaringan::moon_reader:
    includes:
      in_header: qcbsR-header.html
    lib_dir: assets
    seal: true
    css: ["default", "qcbsR.css", "qcbsR-fonts.css"]
    nature:

# Slides 1

---

# Slides 2

```
---

class: inverse, center, middle

# `r icon::fa("rocket")` Blogdown

<html><div style='float:left'></div><hr color='#ffdd55' style="margin-top: -60px;" size=1px width=720px></html> 


---

# Blogdown

#### TODO: Steve

---
# Bookdown - Motivation

.pull-left[
- Producing more complicated documents
- Automatic number and cross-referencing
  - Figures
  - Tables
  - Equations
  - Theorems
  - Custom headers
- Figure formatting and placement
- Customized visuals
]

.pull-right[
```{r, out.width='35%', fig.align='center', echo = F}
knitr::include_graphics('https://bookdown.org/yihui/bookdown/images/logo.png')
```
]

---

# Bookdown - Examples

- Minimal: https://bookdown.org/yihui/bookdown-demo/

<iframe width="100%" height="80%"
src="https://bookdown.org/yihui/bookdown-demo/">
</iframe>

---

# Bookdown - Examples

- Tufte style: https://bookdown.org/yihui/bookdown-demo3/

<iframe width="100%" height="80%"
src="https://bookdown.org/yihui/bookdown-demo3/">
</iframe>

---

# Bookdown - Usage

- Collection of `.Rmd` files
  - Individual chapter for each file
  - Chapter title defined by first-level heading `#`
  - Usual Rmarkdown syntax
  - Rendered by filename order by default

.pull-left[
- `01-Introduction.Rmd`
<br><br><br>
- `02-Chapter1.Rmd`
<br><br><br>
- `03-Conclusion.Rmd`
]

.pull-right[
```{r, eval = F}
# Introduction
This is the introduction
```

```{r, eval = F}
# Chapter 1
This is the Chapter 1
```

```{r, eval = F}
# Conclusion
This is the conclusion
```
]

---

# Bookdown - Usage

- Outputs options
  - `HTML`
  - `pdf`
  - `E-Books`


---

# Bookdown - Getting started

<iframe width="100%" height="90%"
src="https://bookdown.org/yihui/bookdown/get-started.html">
</iframe>

---

# Bookdown - Resources

- Github repository: https://github.com/rstudio/bookdown
- Bookdown book: https://bookdown.org/yihui/bookdown/

